<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs for page bagit_utils.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="file-name">/lib/bagit_utils.php</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
															<a href="#sec-functions">Functions</a>
			</div>
	<div class="info-box-body">	
		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This is a PHP implementation of the <a href="https://wiki.ucop.edu/display/Curation/BagIt">BagIt specification</a>. Really,  it is a port of <a href="https://github.com/ahankinson/pybagit/">PyBagIt</a> for  PHP. This contains some useful functions.</p>
<p class="description"><p>PHP version 5</p><p>Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not  use this file except in compliance with the License. You may obtain a copy of  the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by  applicable law or agreed to in writing, software distributed under the  License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS  OF ANY KIND, either express or implied. See the License for the specific  language governing permissions and limitations under the License.</p></p>
	<ul class="tags">
				<li><span class="field">author:</span> Wayne Graham &lt;<a href="mailto:wayne.graham@gmail.com">wayne.graham@gmail.com</a>&gt;</li>
				<li><span class="field">author:</span> Eric Rochester &lt;<a href="mailto:erochest@gmail.com">erochest@gmail.com</a>&gt;</li>
				<li><span class="field">version:</span> 0.1</li>
				<li><span class="field">copyright:</span> 2011 The Board and Visitors of the University of Virginia</li>
				<li><span class="field">link:</span> <a href="https://github.com/erochest/BagItPHP">https://github.com/erochest/BagItPHP</a></li>
				<li><span class="field">license:</span> <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a></li>
			</ul>
		
			</div>
</div>
		

	
	
	
	<a name="sec-functions"></a>	
	<div class="info-box">
		<div class="info-box-title">Functions</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
															<span class="disabled">Functions</span>
		</div>
		<div class="info-box-body">	
			<a name="functionBagIt_compressBag" id="functionBagIt_compressBag"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">BagIt_compressBag</span> (line <span class="line-number">423</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This compresses the bag into a new file.</p>
	<ul class="tags">
				<li><span class="field">return:</span> The file name for the file.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			BagIt_compressBag
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$dirname</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$output</span>, [<span class="var-type">string</span>&nbsp;<span class="var-name">$method</span> = <span class="var-default">&#039;tgz&#039;</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$dirname</span><span class="var-description">: The directory to compress.</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$output</span><span class="var-description">: The output file.</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$method</span><span class="var-description">: Either 'tgz' or 'zip'. Default is 'tgz'.</span>			</li>
				</ul>
		
	
</div>
<a name="functionBagIt_parseBagInfo" id="functionBagIt_parseBagInfo"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">BagIt_parseBagInfo</span> (line <span class="line-number">474</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Parse bag info file.</p>
	<ul class="tags">
				<li><span class="field">return:</span> The parsed bag-info data.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			BagIt_parseBagInfo
		</span>
					(<span class="var-type">array</span>&nbsp;<span class="var-name">$lines</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$lines</span><span class="var-description">: An array of lines from the file.</span>			</li>
				</ul>
		
	
</div>
<a name="functionBagIt_parseEncodingString" id="functionBagIt_parseEncodingString"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">BagIt_parseEncodingString</span> (line <span class="line-number">356</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This parses the encoding string from the bagit.txt file.</p>
	<ul class="tags">
				<li><span class="field">return:</span> The encoding.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			BagIt_parseEncodingString
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$bagitFileData</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$bagitFileData</span><span class="var-description">: The contents of the bagit file.</span>			</li>
				</ul>
		
	
</div>
<a name="functionBagIt_parseVersionString" id="functionBagIt_parseVersionString"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">BagIt_parseVersionString</span> (line <span class="line-number">328</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This parses the version string from the bagit.txt file.</p>
	<ul class="tags">
				<li><span class="field">return:</span> A two-item array containing the version string as  integers. The keys for this array are 'major' and 'minor'.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			BagIt_parseVersionString
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$bagitFileData</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$bagitFileData</span><span class="var-description">: The contents of the bagit file.</span>			</li>
				</ul>
		
	
</div>
<a name="functionBagIt_readBagItFile" id="functionBagIt_readBagItFile"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">BagIt_readBagItFile</span> (line <span class="line-number">294</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This reads the information from the bag it file.</p>
	<ul class="tags">
				<li><span class="field">return:</span> An array triple of the version, the file encoding, and any  errors encountered.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			BagIt_readBagItFile
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$filename</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$filename</span><span class="var-description">: The bagit.txt file to read.</span>			</li>
				</ul>
		
	
</div>
<a name="functionBagIt_sanitizeFileName" id="functionBagIt_sanitizeFileName"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">BagIt_sanitizeFileName</span> (line <span class="line-number">262</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This cleans up the file name.</p>
	<ul class="tags">
				<li><span class="field">return:</span> The cleaned up file name.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			BagIt_sanitizeFileName
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$filename</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$filename</span><span class="var-description">: The file name to clean up.</span>			</li>
				</ul>
		
	
</div>
<a name="functionBagIt_uncompressBag" id="functionBagIt_uncompressBag"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">BagIt_uncompressBag</span> (line <span class="line-number">379</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This uncompresses a bag.</p>
	<ul class="tags">
				<li><span class="field">return:</span> bagDirectory.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">The</span>
		<span class="method-name">
			BagIt_uncompressBag
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$compressedFile</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$compressedFile</span><span class="var-description">: The file name of the compressed file.</span>			</li>
				</ul>
		
	
</div>
<a name="functionBagIt_validateExists" id="functionBagIt_validateExists"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">BagIt_validateExists</span> (line <span class="line-number">454</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This validates that a file or directory exists.</p>
	<ul class="tags">
				<li><span class="field">return:</span> True if the file does exist; false otherwise.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">boolean</span>
		<span class="method-name">
			BagIt_validateExists
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$filename</span>, <span class="var-type">array</span>&nbsp;<span class="var-name">&$errors</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$filename</span><span class="var-description">: The file name to check for.</span>			</li>
					<li>
				<span class="var-type">array</span>
				<span class="var-name">&$errors</span><span class="var-description">: The list of errors to add the message to, if the  file doesn't exist.</span>			</li>
				</ul>
		
	
</div>
<a name="functionendsWith" id="functionendsWith"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">endsWith</span> (line <span class="line-number">63</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This tests whether a string ends with another string.</p>
	<ul class="tags">
				<li><span class="field">return:</span> if $suffix occurs at the end of $main.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">True</span>
		<span class="method-name">
			endsWith
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$main</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$suffix</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$main</span><span class="var-description">: The primary string to test.</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$suffix</span><span class="var-description">: The string to test against the end of the other.</span>			</li>
				</ul>
		
	
</div>
<a name="functionfilterArrayMatches" id="functionfilterArrayMatches"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">filterArrayMatches</span> (line <span class="line-number">41</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This filters an array by items that match a regex.</p>
	<ul class="tags">
				<li><span class="field">return:</span> match objects for items from $list that match $regex.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">The</span>
		<span class="method-name">
			filterArrayMatches
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$regex</span>, <span class="var-type">array</span>&nbsp;<span class="var-name">$list</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$regex</span><span class="var-description">: The regex to filter by.</span>			</li>
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$list</span><span class="var-description">: The list of items to filter.</span>			</li>
				</ul>
		
	
</div>
<a name="functionfindFirstExisting" id="functionfindFirstExisting"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">findFirstExisting</span> (line <span class="line-number">197</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This returns the first file name that exists, or the default if none do.</p>
	<ul class="tags">
				<li><span class="field">return:</span> The name of the first existing file.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			findFirstExisting
		</span>
					(<span class="var-type">array</span>&nbsp;<span class="var-name">$fileNames</span>, [<span class="var-type">string</span>&nbsp;<span class="var-name">$default</span> = <span class="var-default">null</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$fileNames</span><span class="var-description">: A list of file names to test for.</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$default</span><span class="var-description">: The default value to return. Defaults to null.</span>			</li>
				</ul>
		
	
</div>
<a name="functionreadFileText" id="functionreadFileText"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">readFileText</span> (line <span class="line-number">217</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This reads the data in $fileName and converts it from $fileEncoding to  UTF-8.</p>
	<ul class="tags">
				<li><span class="field">return:</span> The data in $fileName in UTF-8.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			readFileText
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$fileName</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$fileEncoding</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$fileName</span><span class="var-description">: The file name to read.</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$fileEncoding</span><span class="var-description">: The encoding that the text in the file is stored  in.</span>			</li>
				</ul>
		
	
</div>
<a name="functionreadLines" id="functionreadLines"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">readLines</span> (line <span class="line-number">233</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This reads the data in $fileName, converts it from $fileEncoding to UTF-8,  and splits it into lines.</p>
	<ul class="tags">
				<li><span class="field">return:</span> The lines of data in the file.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			readLines
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$fileName</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$fileEncoding</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$fileName</span><span class="var-description">: The file name to read.</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$fileEncoding</span><span class="var-description">: The encoding to that the text in file is stored  in.</span>			</li>
				</ul>
		
	
</div>
<a name="functionrls" id="functionrls"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">rls</span> (line <span class="line-number">77</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This recursively lists the contents of a directory. This doesn't return  hidden files.</p>
	<ul class="tags">
				<li><span class="field">return:</span> A list of files in the directory.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			rls
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$dir</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$dir</span><span class="var-description">: The name of the directory to list.</span>			</li>
				</ul>
		
	
</div>
<a name="functionrrmdir" id="functionrrmdir"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">rrmdir</span> (line <span class="line-number">112</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Recursively delete a directory.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			rrmdir
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$dir</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$dir</span><span class="var-description">: The directory to delete.</span>			</li>
				</ul>
		
	
</div>
<a name="functionsaveUrl" id="functionsaveUrl"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">saveUrl</span> (line <span class="line-number">175</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This copies a URL to a file.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			saveUrl
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$url</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$filename</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$url</span><span class="var-description">: The URL to pull.</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$filename</span><span class="var-description">: The file name to write to.</span>			</li>
				</ul>
		
	
</div>
<a name="functionseenAtKey" id="functionseenAtKey"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">seenAtKey</span> (line <span class="line-number">155</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This tests whether the item is in a list of lists at the given key.</p>
	<ul class="tags">
				<li><span class="field">return:</span> if $item is in a subarray under $key.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">True</span>
		<span class="method-name">
			seenAtKey
		</span>
					(<span class="var-type">array</span>&nbsp;<span class="var-name">$array</span>, <span class="var-type">integer/string</span>&nbsp;<span class="var-name">$key</span>, <span class="var-type">anything</span>&nbsp;<span class="var-name">$item</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$array</span><span class="var-description">: The array of arrays to search.</span>			</li>
					<li>
				<span class="var-type">integer/string</span>
				<span class="var-name">$key</span><span class="var-description">: The key to search under.</span>			</li>
					<li>
				<span class="var-type">anything</span>
				<span class="var-name">$item</span><span class="var-description">: The item to search for.</span>			</li>
				</ul>
		
	
</div>
<a name="functiontmpdir" id="functiontmpdir"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">tmpdir</span> (line <span class="line-number">139</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Get a temporary name and create a directory there.</p>
<p class="description"><p>The caller is responsible for deleting this directory and its contents.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> The name of the temporary directory.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			tmpdir
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$prefix</span> = <span class="var-default">&#039;bag&#039;</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$prefix</span><span class="var-description">: The prefix for the temporary directory.</span>			</li>
				</ul>
		
	
</div>
<a name="functionwriteFileText" id="functionwriteFileText"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">writeFileText</span> (line <span class="line-number">250</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Write the data in the file, converting it from UTF-8 to tagFileEncoding.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			writeFileText
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$fileName</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$fileEncoding</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$data</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$fileName</span><span class="var-description">: The name of the file to write to.</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$fileEncoding</span><span class="var-description">: The encoding that the text in the file is stored  in.</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$data</span><span class="var-description">: The data to write.</span>			</li>
				</ul>
		
	
</div>
		</div>
	</div>
	
	<p class="notes" id="credit">
		Documentation generated on Wed, 15 Jun 2011 10:10:47 -0400 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.3</a>
	</p>
	</div></body>
</html>